<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tram Stop QR Codes</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .stop {
            margin-bottom: 20px;
        }
        img {
            max-width: 150px;
        }
    </style>
</head>

<body>
    <h1>Outgoing Number 11 Tram Stop QR Codes</h1>
    <div id="stop-list">
        <!-- QR codes and URLs will be injected here -->
    </div>

    <script>
        async function loadStopData() {
            try {
                const response = await fetch('/number11tram/outgoing_route_11_stops.json'); // Load the tram stop data
                let stops = await response.json();

                // Sort stops by stop_sequence to ensure correct outbound order
                stops = stops.sort((a, b) => a.stop_sequence - b.stop_sequence);

                const stopList = document.getElementById('stop-list');
                
                stops.forEach(stop => {
                    const stopDiv = document.createElement('div');
                    stopDiv.classList.add('stop');
                    
                    const stopId = stop.stop_id;
                    const stopName = stop.stop_name;
                    const stopLandmark = stop.stop_landmark || 'No Landmark';

                    // Update URL for each stop
                    const stopUrl = `https://lml.live/number11tram/index.html?stopId=${stopId}`;
                    const qrCodeUrl = `https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${stopUrl}`; // Generate QR code

                    stopDiv.innerHTML = `
                        <h2>Stop ${stopId} - ${stopName}</h2>
                        <a href="${stopUrl}" target="_blank">
                            <img src="${qrCodeUrl}" alt="QR Code for Stop ${stopId}" />
                        </a>
                        <p><a href="${stopUrl}" target="_blank">View Stop Details</a></p>
                    `;

                    stopList.appendChild(stopDiv);
                });
            } catch (error) {
                console.error('Error loading stop data:', error);
            }
        }

        // Load stop data when the page is ready
        document.addEventListener('DOMContentLoaded', loadStopData);
    </script>
</body>
</html>
